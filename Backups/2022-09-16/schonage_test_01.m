clear; clc;
format long g;

%% R[x]/(x^677-1) â‡’ R[x]

f_11 = [1383, 105, 1105, 1098, 1833, 186, 498, 483, 124, 84, 795, 1511, 1910, 302, 563, 1225, 870, 13, 561, 163, 293, 261, ...
    88, 1118, 1451, 205, 1691, 1108, 1038, 116, 1313, 1500, 624, 62, 577, 1532, 574, 1662, 490, 875, 1935, 92, 748, 1083,  ...
    562, 1340, 492, 2011, 258, 254, 251, 1706, 1531, 1489, 5, 1916, 1397, 1470, 1161, 1884, 1704, 1551, 1969, 1265, 1541,  ...
    1015, 1257, 570, 1994, 715, 328, 1892, 543, 1822, 1820, 1380, 788, 1626, 350, 889, 315, 1636, 529, 265, 170, 428, 1563,  ...
    175, 1587, 1763, 1608, 789, 1979, 1058, 1210, 125, 1803, 1050, 1919, 760, 248, 539, 1461, 1870, 664, 312, 633, 573, 1468,  ...
    846, 1530, 108, 684, 1569, 426, 597, 1470, 437, 1851, 1884, 1846, 691, 1250, 996, 847, 1301, 765, 1614, 520, 2004, 1418,  ...
    1620, 1690, 1724, 270, 1960, 1708, 499, 1868, 1581, 1289, 997, 196, 1455, 1699, 1663, 1965, 1910, 1246, 1052, 1098, 1584,  ...
    1568, 1669, 1531, 7, 2036, 779, 1568, 902, 1598, 241, 1753, 1075, 1689, 419, 1044, 1497, 2039, 1952, 272, 246, 916, 446,  ...
    1212, 1656, 1865, 230, 2000, 474, 1386, 332, 849, 947, 900, 314, 763, 1433, 1586, 68, 1179, 1513, 1573, 520, 1001, 1118,  ...
    1888, 722, 1232, 1530, 472, 1256, 358, 868, 473, 647, 613, 602, 1855, 1664, 68, 1148, 137, 599, 1491, 1453, 1926, 1152,  ...
    1303, 133, 908, 1382, 892, 1660, 1058, 1508, 2010, 1035, 431, 1468, 1716, 1839, 1535, 1831, 915, 519, 696, 1297, 1837,  ...
    239, 137, 1974, 309, 199, 548, 615, 493, 1810, 1349, 770, 1509, 2040, 1143, 1745, 150, 1780, 1685, 386, 620, 686, 205,  ...
    1384, 1708, 678, 692, 1226, 690, 311, 459, 719, 1993, 896, 110, 1576, 1868, 1898, 1517, 723, 332, 139, 802, 1178, 536, 1278,  ...
    1497, 1605, 401, 1025, 1737, 1241, 769, 1583, 277, 1415, 1660, 1634, 873, 1906, 205, 357, 1086, 1097, 369, 1998, 629, 1615,  ...
    234, 1636, 1409, 1121, 510, 1435, 1471, 745, 382, 1330, 1017, 908, 455, 1444, 2, 434, 114, 748, 1025, 496, 528, 871, 1177, 1627, ... 
    671, 980, 1290, 1027, 700, 781, 1435, 939, 1237, 1025, 1509, 1750, 1405, 1989, 142, 46, 431, 454, 867, 1418, 1904, 222, 1366,  ...
    794, 801, 769, 1293, 253, 1046, 1185, 1763, 2002, 210, 1867, 1889, 597, 1388, 989, 1980, 1261, 1555, 997, 455, 1451, 1444, 641,  ...
    1820, 1306, 1003, 1060, 315, 542, 428, 362, 1267, 1094, 1607, 1574, 1293, 1515, 1567, 1850, 704, 1322, 186, 504, 1991, 158, 529,  ...
    731, 96, 522, 1869, 1717, 1027, 1805, 1293, 1885, 667, 1656, 1493, 1356, 1158, 1807, 2034, 1436, 269, 1786, 2008, 1205, 592, 1533,  ...
    521, 1834, 482, 2043, 1555, 1364, 817, 306, 1614, 886, 1653, 1974, 33, 552, 46, 463, 1408, 1756, 1692, 1817, 1054, 1866, 209, 627,  ...
    1866, 1659, 90, 1037, 668, 749, 1627, 1282, 1461, 829, 694, 258, 1732, 1572, 200, 1717, 1664, 1490, 865, 1878, 22, 200, 1791, 589,  ...
    424, 263, 2017, 819, 597, 1595, 494, 815, 544, 1865, 738, 895, 227, 361, 529, 1176, 321, 24, 1960, 1992, 1186, 1306, 756, 1790, 331,  ...
    662, 1256, 1829, 604, 1454, 1093, 39, 2021, 1705, 906, 394, 1141, 1724, 1774, 1151, 1026, 1127, 1323, 1718, 1051, 1013, 1707, 1511,  ...
    1115, 1566, 770, 17, 1613, 1761, 1159, 1396, 630, 372, 1384, 1832, 1167, 484, 1849, 458, 1116, 889, 1937, 1750, 599, 793, 280, 1897, 617,  ...
    815, 264, 340, 1397, 209, 773, 67, 644, 1728, 1863, 2035, 845, 125, 921, 2035, 196, 1491, 1402, 1891, 609, 1949, 719, 1223, 925, 1896, 285,  ...
    1154, 615, 208, 1254, 1027, 998, 1910, 255, 1103, 1805, 198, 973, 1840, 277, 590, 1524, 1693, 977, 1629, 50, 1634, 1079, 1401, 1202, 150,  ...
    1461, 1436, 1770, 237, 870, 561, 525, 438, 61, 1685, 628, 1159, 720, 994, 969, 833, 1493, 769, 1451, 1214, 1835, 619, 1982, 1814, 1077,  ...
    106, 675, 1365, 1778, 1269, 1455, 1082, 276, 67, 810, 2000, 1009, 909, 1630, 939, 79, 317, 263, 101, 1993, 693, 1424, 253, 1579, 1380,  ...
    1602, 939, 1905, 1506, 476, 98, 1443, 1309, 49, 1700, 732, 1395, 73, 1809, 1968, 1994, 427, 37, 685, 1771, 1941, 1716, 237, 995, 339,  ...
    281, 993, 1180, 1276, 671, 35, 671, 1502];

% This is g on Z/2048Z (2047 = -1)
g_11 = [1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 2047, 0, 2047, 1, 1, 0, 0, 0, 1, 1, 0, 2047, 1, 2047, 0, 1, 2047, 0, 2047, 1, 0, 0, 2047, 0, 2047, 0, 0, 0, 2047,   ...
    2047, 0, 2047, 0, 2047, 1, 0, 0, 1, 0, 2047, 1, 1, 0, 2047, 0, 2047, 2047, 1, 2047, 2047, 0, 1, 2047, 2047, 1, 1, 0, 2047, 2047, 2047, 0, 2047, 2047,   ...
    0, 2047, 0, 2047, 1, 0, 2047, 1, 2047, 2047, 1, 1, 1, 2047, 0, 1, 1, 2047, 1, 2047, 1, 1, 1, 1, 2047, 0, 0, 1, 1, 2047, 1, 1, 0, 0, 0, 0, 2047, 2047,   ...
    2047, 0, 2047, 1, 2047, 2047, 0, 1, 2047, 0, 0, 2047, 1, 1, 1, 0, 2047, 2047, 0, 2047, 1, 2047, 0, 2047, 0, 2047, 1, 2047, 2047, 1, 2047, 0, 2047, 1, 0,   ...
    0, 1, 2047, 0, 2047, 0, 1, 0, 0, 2047, 1, 0, 2047, 2047, 0, 0, 1, 1, 2047, 1, 2047, 0, 2047, 1, 1, 2047, 1, 2047, 0, 2047, 0, 1, 2047, 2047, 2047, 2047,   ...
    0, 1, 1, 1, 2047, 2047, 1, 1, 1, 1, 1, 1, 2047, 0, 1, 2047, 1, 0, 1, 0, 0, 0, 2047, 1, 2047, 0, 0, 0, 0, 2047, 1, 1, 2047, 1, 0, 1, 2047, 0, 0, 0, 2047,   ...
    1, 2047, 2047, 0, 1, 2047, 0, 2047, 0, 2047, 2047, 2047, 0, 2047, 0, 1, 1, 1, 2047, 0, 1, 2047, 0, 1, 2047, 0, 2047, 0, 0, 2047, 0, 0, 0, 0, 1, 2047, 2047,   ...
    2047, 1, 0, 0, 2047, 1, 1, 1, 0, 1, 1, 1, 1, 2047, 0, 1, 2047, 2047, 0, 1, 1, 1, 0, 1, 2047, 1, 0, 0, 2047, 2047, 1, 0, 1, 0, 1, 1, 0, 2047, 1, 0, 1, 1, 1,   ...
    1, 1, 1, 2047, 1, 0, 2047, 2047, 1, 1, 2047, 2047, 2047, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 2047, 0, 0, 2047, 0, 0, 1, 2047, 1, 1, 2047, 2047,   ...
    1, 0, 0, 0, 2047, 2047, 0, 2047, 2047, 2047, 0, 2047, 2047, 1, 0, 0, 2047, 2047, 0, 0, 0, 0, 1, 1, 2047, 2047, 2047, 2047, 2047, 0, 0, 0, 2047, 0, 0, 1, 0,   ...
    2047, 2047, 1, 2047, 1, 2047, 0, 2047, 0, 2047, 0, 1, 0, 0, 1, 2047, 0, 1, 2047, 0, 0, 2047, 0, 2047, 1, 1, 2047, 0, 2047, 0, 0, 1, 0, 2047, 2047, 2047, 0,   ...
    1, 0, 1, 0, 1, 2047, 1, 1, 2047, 2047, 0, 1, 1, 0, 0, 2047, 0, 2047, 2047, 2047, 0, 1, 0, 1, 0, 1, 2047, 1, 1, 1, 2047, 0, 2047, 0, 1, 0, 1, 1, 0, 1, 1, 0,   ...
    1, 0, 0, 2047, 1, 0, 1, 2047, 1, 2047, 2047, 1, 0, 0, 1, 0, 0, 2047, 1, 0, 0, 1, 2047, 2047, 1, 1, 1, 2047, 0, 2047, 1, 1, 2047, 0, 1, 1, 2047, 1, 1, 2047,   ...
    1, 1, 2047, 0, 2047, 1, 1, 1, 2047, 0, 2047, 0, 0, 1, 2047, 2047, 1, 2047, 2047, 2047, 0, 1, 1, 2047, 2047, 2047, 0, 0, 2047, 0, 1, 2047, 1, 2047, 0, 1, 0,   ...
    2047, 0, 1, 1, 0, 2047, 1, 0, 0, 2047, 2047, 2047, 1, 2047, 0, 1, 1, 1, 0, 2047, 1, 2047, 1, 2047, 0, 1, 2047, 0, 2047, 2047, 1, 0, 2047, 1, 2047, 2047, 2047,   ...
    2047, 0, 2047, 1, 2047, 0, 0, 0, 2047, 2047, 0, 0, 2047, 2047, 1, 1, 0, 0, 1, 2047, 1, 1, 1, 0, 2047, 0, 1, 1, 0, 2047, 0, 1, 0, 0, 0, 1, 0, 2047, 0, 2047,   ...
    2047, 2047, 1, 1, 1, 0, 2047, 2047, 0, 2047, 1, 0, 1, 1, 2047, 1, 1, 0, 1, 2047, 0, 2047, 1, 0, 0, 2047, 1, 2047, 1, 2047, 1, 2047, 0, 0, 2047, 1, 0, 2047,   ...
    2047, 0, 0, 2047, 2047, 2047, 0, 0, 2047, 2047, 2047, 0, 2047, 2047, 0, 2047, 2047, 2047, 2047, 2047, 1, 2047, 0, 1, 0];

% This is g on Z/65536Z (65535 = -1)
g_16=[1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 65535, 0, 65535, 1, 1, 0, 0, 0, 1, 1, 0, 65535, 1, 65535, 0, 1, 65535, 0, 65535, 1, 0, 0, 65535, 0, 65535, 0, 0, 0, 65535, 65535, ...
    0, 65535, 0, 65535, 1, 0, 0, 1, 0, 65535, 1, 1, 0, 65535, 0, 65535, 65535, 1, 65535, 65535, 0, 1, 65535, 65535, 1, 1, 0, 65535, 65535, 65535, 0, 65535, 65535, 0, 65535, ...
    0, 65535, 1, 0, 65535, 1, 65535, 65535, 1, 1, 1, 65535, 0, 1, 1, 65535, 1, 65535, 1, 1, 1, 1, 65535, 0, 0, 1, 1, 65535, 1, 1, 0, 0, 0, 0, 65535, 65535, 65535, 0, 65535, 1, ...
    65535, 65535, 0, 1, 65535, 0, 0, 65535, 1, 1, 1, 0, 65535, 65535, 0, 65535, 1, 65535, 0, 65535, 0, 65535, 1, 65535, 65535, 1, 65535, 0, 65535, 1, 0, 0, 1, 65535, 0, 65535, ...
    0, 1, 0, 0, 65535, 1, 0, 65535, 65535, 0, 0, 1, 1, 65535, 1, 65535, 0, 65535, 1, 1, 65535, 1, 65535, 0, 65535, 0, 1, 65535, 65535, 65535, 65535, 0, 1, 1, 1, 65535, 65535, 1, ...
    1, 1, 1, 1, 1, 65535, 0, 1, 65535, 1, 0, 1, 0, 0, 0, 65535, 1, 65535, 0, 0, 0, 0, 65535, 1, 1, 65535, 1, 0, 1, 65535, 0, 0, 0, 65535, 1, 65535, 65535, 0, 1, 65535, 0, 65535, 0, ...
    65535, 65535, 65535, 0, 65535, 0, 1, 1, 1, 65535, 0, 1, 65535, 0, 1, 65535, 0, 65535, 0, 0, 65535, 0, 0, 0, 0, 1, 65535, 65535, 65535, 1, 0, 0, 65535, 1, 1, 1, 0, 1, 1, 1, 1, 65535, ...
    0, 1, 65535, 65535, 0, 1, 1, 1, 0, 1, 65535, 1, 0, 0, 65535, 65535, 1, 0, 1, 0, 1, 1, 0, 65535, 1, 0, 1, 1, 1, 1, 1, 1, 65535, 1, 0, 65535, 65535, 1, 1, 65535, 65535, 65535, 1, 1, 0, ...
    1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 65535, 0, 0, 65535, 0, 0, 1, 65535, 1, 1, 65535, 65535, 1, 0, 0, 0, 65535, 65535, 0, 65535, 65535, 65535, 0, 65535, 65535, 1, 0, 0, 65535, ...
    65535, 0, 0, 0, 0, 1, 1, 65535, 65535, 65535, 65535, 65535, 0, 0, 0, 65535, 0, 0, 1, 0, 65535, 65535, 1, 65535, 1, 65535, 0, 65535, 0, 65535, 0, 1, 0, 0, 1, 65535, 0, 1, 65535, ...
    0, 0, 65535, 0, 65535, 1, 1, 65535, 0, 65535, 0, 0, 1, 0, 65535, 65535, 65535, 0, 1, 0, 1, 0, 1, 65535, 1, 1, 65535, 65535, 0, 1, 1, 0, 0, 65535, 0, 65535, 65535, 65535, 0, 1, 0, ...
    1, 0, 1, 65535, 1, 1, 1, 65535, 0, 65535, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 65535, 1, 0, 1, 65535, 1, 65535, 65535, 1, 0, 0, 1, 0, 0, 65535, 1, 0, 0, 1, 65535, 65535, 1, 1, 1, ...
    65535, 0, 65535, 1, 1, 65535, 0, 1, 1, 65535, 1, 1, 65535, 1, 1, 65535, 0, 65535, 1, 1, 1, 65535, 0, 65535, 0, 0, 1, 65535, 65535, 1, 65535, 65535, 65535, 0, 1, 1, 65535, 65535, ...
    65535, 0, 0, 65535, 0, 1, 65535, 1, 65535, 0, 1, 0, 65535, 0, 1, 1, 0, 65535, 1, 0, 0, 65535, 65535, 65535, 1, 65535, 0, 1, 1, 1, 0, 65535, 1, 65535, 1, 65535, 0, 1, 65535, 0, ...
    65535, 65535, 1, 0, 65535, 1, 65535, 65535, 65535, 65535, 0, 65535, 1, 65535, 0, 0, 0, 65535, 65535, 0, 0, 65535, 65535, 1, 1, 0, 0, 1, 65535, 1, 1, 1, 0, 65535, 0, 1, 1, 0, 65535, ...
    0, 1, 0, 0, 0, 1, 0, 65535, 0, 65535, 65535, 65535, 1, 1, 1, 0, 65535, 65535, 0, 65535, 1, 0, 1, 1, 65535, 1, 1, 0, 1, 65535, 0, 65535, 1, 0, 0, 65535, 1, 65535, 1, 65535, 1, 65535, ...
    0, 0, 65535, 1, 0, 65535, 65535, 0, 0, 65535, 65535, 65535, 0, 0, 65535, 65535, 65535, 0, 65535, 65535, 0, 65535, 65535, 65535, 65535, 65535, 1, 65535, 0, 1, 0];

% h = f*g on Z/2048Z not reduced
h_expected_1111 = [17396, 27415, 56294, 58574, 63655, 2337, 19941, 53336, 46938, 5113, 33025, 41920, 2580, 11498, 49276, 3423, 38396, 8558, 40084, 44637, 8086, 51945, 40174, 47158, ...
    2391, 33231, 193, 20445, 59240, 63658, 10836, 23825, 11765, 58106, 60427, 24463, 55386, 22897, 36924, 20480, 36168, 49167, 26629, 11134, 475, 32681, 58787, 36964, 9435, 12467, ...
    21516, 57986, 27609, 26362, 54508, 45040, 64842, 50846, 55066, 21428, 6174, 11096, 50858, 53149, 6219, 59717, 31664, 16534, 4332, 59142, 21061, 275, 30728, 35326, 17315, 6913, ...
    6540, 21986, 58665, 15082, 51083, 60119, 46065, 47007, 59550, 42945, 32940, 7907, 51154, 32266, 39066, 52724, 24756, 44133, 26366, 45004, 37936, 45919, 9456, 11182, 51139, 62225, ...
    50573, 1215, 23096, 31154, 3870, 34869, 17522, 61180, 23707, 30594, 10950, 11506, 55503, 61478, 32203, 51884, 58184, 57689, 58687, 61910, 40152, 62065, 24523, 7303, 14304, 49259, ...
    13664, 20988, 23208, 46486, 49971, 9660, 56010, 28160, 60191, 21428, 55476, 41537, 17486, 32385, 41671, 40010, 9439, 55449, 11469, 19544, 61393, 59027, 34349, 1331, 23641, 25928, ...
    6407, 34504, 9783, 54705, 10087, 49530, 21250, 666, 6981, 44616, 65268, 39470, 51688, 24771, 64983, 60160, 35047, 14794, 12828, 18628, 64419, 39670, 40670, 26997, 6395, 15738, 7247, ...
    7262, 24951, 35888, 37615, 4880, 54938, 62629, 22537, 20864, 22369, 25709, 18827, 34972, 23927, 45758, 44563, 14743, 54213, 16476, 47107, 22586, 10935, 65302, 10151, 2616, 3064, ...
    43457, 18003, 42790, 4670, 43948, 61734, 37450, 33153, 47232, 8754, 45756, 26933, 37350, 41053, 35616, 1411, 34924, 28851, 4359, 29982, 60119, 14638, 38946, 47114, 39304, 26128, ...
    29837, 56736, 1292, 15241, 64505, 43824, 63754, 35672, 33942, 19884, 47432, 60294, 44028, 14849, 14905, 60980, 11057, 32272, 23218, 46174, 45121, 63000, 14801, 1186, 26739, 33679, ...
    31076, 16560, 16813, 56280, 13852, 35968, 10089, 25986, 60412, 7283, 28522, 39696, 50232, 49716, 10794, 34506, 49863, 20234, 15817, 23478, 59030, 40090, 6809, 34332, 39402, 59203, ...
    15685, 62042, 14589, 29515, 10327, 23209, 338, 29424, 43583, 3889, 54743, 20812, 29987, 43997, 46779, 23576, 65425, 64542, 60236, 63259, 34306, 49338, 1020, 53691, 55749, 61413, ...
    17436, 23849, 41177, 33156, 64781, 61157, 17032, 36740, 23204, 46628, 27524, 35807, 55778, 45785, 56771, 43652, 9638, 58482, 13813, 39772, 9521, 25219, 55271, 28132, 28133, 6223, ...
    64171, 1903, 58498, 4485, 46189, 19442, 22450, 15182, 36593, 20498, 65049, 23496, 41791, 8136, 9238, 39159, 58586, 42871, 22205, 45750, 23376, 65415, 63474, 43583, 30092, 9999, ...
    32609, 54679, 64584, 48976, 52975, 37135, 64993, 52492, 52418, 30682, 42443, 22883, 27004, 42699, 11208, 24091, 39410, 56695, 27599, 46083, 46088, 51943, 43053, 43757, 16332, 46894, ...
    51073, 37455, 54069, 49273, 33477, 56881, 37799, 34086, 63715, 64988, 3193, 7267, 7371, 36984, 62634, 9290, 62879, 44314, 62236, 11467, 22933, 34332, 29878, 16899, 25808, 62435, ...
    60107, 2145, 44535, 58510, 43494, 54148, 20958, 21980, 23927, 25294, 16031, 20365, 44532, 46097, 45696, 62883, 9000, 25628, 24007, 32939, 47943, 20320, 51975, 36610, 31353, 50481, ...
    39348, 62095, 52623, 2056, 15527, 46846, 35340, 910, 57887, 31192, 7709, 911, 21300, 2028, 6793, 22423, 36681, 30980, 57675, 39717, 12573, 36528, 48189, 22195, 18110, 12473, 31070, ...
    57099, 15015, 35707, 13399, 46366, 63257, 13668, 38553, 6865, 24918, 30746, 29181, 48629, 33704, 62319, 41724, 54547, 20643, 5624, 58493, 810, 23013, 60078, 8045, 59351, 17839, ...
    27349, 1804, 47514, 50599, 35920, 65134, 37368, 43336, 56421, 56597, 3656, 17291, 6900, 7121, 63760, 30664, 32256, 16298, 33160, 867, 17874, 32420, 42463, 25933, 35352, 393, 56940, ...
    18030, 2051, 46743, 53184, 5714, 60374, 61889, 4139, 40298, 1797, 38, 28124, 18252, 50699, 18601, 26415, 40407, 28644, 27162, 61170, 50552, 60791, 3382, 60168, 11182, 25770, 57063, ...
    13225, 36416, 20871, 53165, 4800, 42345, 36417, 37311, 52299, 14334, 22432, 22754, 7034, 14008, 27882, 46409, 18472, 61944, 59285, 20982, 63262, 39675, 21118, 879, 51460, 23574, 55435, ...
    51423, 28431, 20918, 4876, 41114, 59198, 9874, 8067, 37850, 61163, 13615, 23213, 19753, 4396, 39555, 9332, 39348, 31923, 8957, 38171, 35255, 43220, 19565, 26692, 4516, 30897, 42861, ...
    23616, 42229, 47651, 54657, 8959, 39130, 3939, 48739, 61237, 61588, 59580, 61750, 27314, 140, 5639, 57200, 45367, 865, 55846, 2419, 7161, 39311, 43618, 44267, 58732, 12784, 627, 1883, ...
    49240, 53217, 5369, 53662, 41608, 26112, 26105, 41904, 35628, 8525, 34546, 2658, 2897, 51410, 19690, 15904, 29575, 10183, 14275, 10015, 28511, 60634, 1750, 55471, 57523, 50151, 21342, ...
    49180, 63567, 25256, 61099, 54802, 57255, 57586, 16430, 44178, 53802, 31032, 22376, 24817, 46877, 21402, 48860, 34410, 9070, 61741, 41903];

% h = f*g on Z/65535 not reduced
h_expected_1116 = [50164, 58135, 44006, 9422, 8359, 57633, 40421, 47192, 44890, 62457, 47361, 64448, 532, 5354, 24700, 62815, 52732, 366, 50324, 32349, 57238, 64233, 44270, 32822, 41303, 43471, ...
    37057, 59357, 55144, 63658, 64084, 21777, 50677, 43770, 25611, 46991, 53338, 43377, 12348, 34816, 52552, 51215, 38917, 39806, 59867, 42921, 44451, 30820, 40155, 47283, 54284, 55938, 50137, 61178, ...
    46316, 32752, 46410, 63134, 61210, 64436, 2078, 31576, 42666, 30621, 59467, 63813, 58288, 39062, 51436, 1798, 62021, 275, 49160, 55806, 41891, 62209, 2444, 5602, 46377, 45802, 46987, 60119, 58353, ...
    32671, 51358, 34753, 55468, 42723, 51154, 28170, 32922, 11764, 10420, 48229, 50942, 40908, 46128, 29535, 42224, 54190, 34755, 33553, 42381, 62655, 39480, 59826, 55070, 53301, 52338, 26364, 40091, ...
    55170, 23238, 44274, 32975, 51238, 34251, 58028, 29512, 53593, 34111, 43478, 25816, 49777, 24523, 54407, 24544, 53355, 52576, 45564, 39592, 54678, 52019, 54716, 2762, 46592, 51999, 33716, 12468, ...
    53825, 54350, 63105, 25287, 62538, 38111, 47257, 56525, 58456, 47057, 5779, 63021, 64819, 54361, 62792, 59655, 11976, 63031, 1457, 3943, 49530, 62210, 51866, 37701, 46664, 63220, 57902, 55784, 51395, ...
    44503, 58112, 61671, 55754, 25116, 59588, 37795, 51958, 1758, 49525, 61691, 46458, 1103, 48222, 61815, 56368, 33519, 45840, 48794, 11429, 36873, 31104, 28513, 46189, 39307, 24732, 42359, 39614, ...
    48659, 49559, 31685, 28764, 57347, 12346, 41655, 50966, 57255, 51768, 33784, 31169, 52819, 53030, 27198, 23468, 43302, 49738, 55681, 53376, 562, 37564, 31029, 43494, 8285, 39712, 52611, 57452, 55475, ...
    37127, 1310, 64215, 49454, 26658, 55306, 59784, 40464, 60557, 58784, 46348, 62345, 41977, 60208, 47370, 58200, 56470, 60844, 14664, 39814, 46076, 33281, 59961, 56884, 35633, 62992, 58034, 52318, ...
    4161, 40472, 51665, 60578, 49267, 31631, 45412, 63664, 35245, 33752, 46620, 46208, 30569, 58754, 44028, 42099, 51050, 49936, 50232, 55860, 31274, 32458, 41671, 59146, 44489, 43958, 30358, 56474, ...
    8857, 65052, 47594, 24387, 48453, 41562, 28925, 37707, 45143, 27305, 51538, 62192, 575, 38705, 34263, 33100, 36131, 7133, 32443, 27672, 49041, 60446, 39756, 46875, 54786, 53434, 46076, 41403, 55749, ...
    51173, 42012, 25897, 59609, 47492, 54541, 57061, 43656, 57220, 39588, 60964, 52100, 25567, 43490, 15065, 58819, 49796, 48550, 46194, 40437, 60252, 9521, 4739, 32743, 48612, 42469, 63567, 45739, ...
    1903, 48258, 59781, 52333, 48114, 57266, 37710, 59121, 45074, 42521, 41928, 19263, 40904, 33814, 55543, 40154, 46967, 59069, 55990, 39760, 12167, 59378, 49727, 5516, 34575, 24417, 60823, 7240, ...
    46928, 36591, 59663, 58849, 46348, 54466, 47066, 3531, 53603, 57724, 48843, 46024, 65051, 55794, 56695, 56271, 46083, 48136, 31463, 63533, 56045, 51148, 65326, 32641, 62031, 6965, 2169, 23237, 42545, ...
    45991, 32038, 39139, 44508, 52345, 44131, 42187, 26744, 33962, 52298, 34207, 40218, 54044, 48331, 39317, 52764, 33974, 47619, 50384, 64483, 60107, 39009, 42487, 64654, 57830, 64388, 4574, 40412, 46455, ...
    39630, 3743, 51085, 48628, 52241, 39552, 62883, 54056, 50204, 48583, 61611, 45895, 65376, 54023, 65282, 53881, 60721, 59828, 39567, 54671, 53256, 29863, 52990, 6668, 50062, 41503, 41432, 32285, 60303, ...
    820, 2028, 33417, 61335, 63305, 45316, 47435, 2853, 53533, 30384, 48189, 52915, 57022, 53433, 55646, 57099, 53927, 45947, 58455, 44318, 32537, 48484, 38553, 62161, 47446, 38938, 41469, 42485, 37800, ...
    27503, 45820, 36115, 39075, 44536, 52349, 31530, 39397, 43694, 38765, 53207, 50607, 53973, 32524, 45466, 42407, 56400, 30318, 25080, 45384, 44133, 52501, 46664, 33675, 47860, 29649, 6416, 32712, 65024, ...
    26538, 49544, 58211, 40402, 42660, 11743, 34125, 55832, 37257, 1644, 44654, 55299, 32407, 53184, 44626, 7126, 41409, 57387, 21866, 48901, 2086, 64988, 10060, 32267, 49321, 61231, 52695, 42980, 41498, ...
    38642, 56696, 62839, 52534, 29448, 54190, 40106, 34535, 43945, 48704, 57735, 28589, 47808, 62825, 65089, 51647, 64587, 65534, 63392, 49378, 19322, 61112, 38122, 60745, 43048, 51704, 57237, 43510, 46878, ...
    39675, 64126, 21359, 55556, 46102, 51339, 57567, 61199, 55734, 47884, 154, 42814, 52882, 65411, 46042, 34539, 13615, 685, 64809, 51500, 43651, 38004, 47540, 56499, 2813, 58651, 47543, 61652, 46189, 61508, ...
    49572, 43185, 28525, 35904, 25845, 45603, 60801, 33535, 61658, 44899, 58979, 57141, 59540, 61628, 39222, 21170, 47244, 3591, 57200, 39223, 52065, 53798, 53619, 39929, 39311, 60002, 40171, 48492, ...
    25072, 627, 42843, 16472, 63457, 52473, 41374, 27272, 60928, 52729, 23472, 31532, 26957, 46834, 57954, 4945, 24786, 46314, 36384, 37767, 40903, 63427, 22303, 34655, 42202, 52950, 12463, 61619, 39911, ...
    62302, 51228, 47183, 60072, 11947, 52754, 57255, 41202, 38958, 48274, 35370, 45368, 59240, 14577, 50973, 52122, 50908, 63082, 43886, 45357, 58287];

f_debug = [1383,105,1105,1098,1833,186,498,483];
g_debug = [1,1,1,0,1,1,1,1];
h_debug_expected = [6505,6193,6208,5308,6586,5586,5593,4858];

%TEST equality
%h_test_1116 = textbook_multiplication(f_11,g_16);
%mod(h_test_1116,2^16)-mod(h_expected_1116,2^16);

%% R[x] â‡’ R[x]/(x^1536-1)

% We must convert the arrays to dim 1536

f_11_1536 = forward_expandDimension(f_11);
g_16_1536 = forward_expandDimension(g_16);

%TEST SECTION
f_11_outTest = back_expandDimension(f_11_1536);
g_16_outTest = back_expandDimension(g_16_1536);

disp('Test of forward_back_expandDimension')
[isequal(f_11,f_11_outTest), isequal(g_16,g_16_outTest)]

%   ORIGINAL
% f_11_1536 = [f_11 zeros(1,1536-677)];
% g_16_1536 = [g_16 zeros(1,1536-677)];


%% R[x]/(x^1536-1) â‡’  R[y,z]/(y^512-1,z^3-1) â‡’ (R[y]/(y^512-1))^3

f_split01 = forward_split01(f_11_1536);
g_split01 = forward_split01(g_16_1536);


%TEST SECTION
f_11_1536_outTest = back_split01(f_split01);
g_16_1536_outTest = back_split01(g_split01);

disp('Test of forward_back_expandDimension')
[isequal(f_11_1536,f_11_1536_outTest), isequal(g_16_1536,g_16_1536_outTest)]


%ORIGINAL
% f_split01 = zeros(3,512);
% g_split01 = zeros(3,512);
% 
% for i=0:1535
%     index_y = mod(i,2^9);
%     index_z = mod(i,3);
% 
%     index_y_corrected = index_y+1;
% 
%     if(index_z==0)
%         f_split01(1,index_y_corrected) = f_11_1536(i+1);
%         g_split01(1,index_y_corrected) = g_16_1536(i+1);
%     elseif(index_z==1)
%         f_split01(2,index_y_corrected) = f_11_1536(i+1);
%         g_split01(2,index_y_corrected) = g_16_1536(i+1);
%     else
%         f_split01(3,index_y_corrected) = f_11_1536(i+1);
%         g_split01(3,index_y_corrected) = g_16_1536(i+1);
%     end.
% end

% At this point, we have already f and g in (R[y]/(y^512-1))^3

%% R[y]/(y^512-1) â‡’ R[y,w]/(y^16-w, w^32-1) with y^16=w â‡’ R[y,w]/(w^32-1)
%Note: For Good's trick, we would need gcd(16,32)=1 but this is not the
%case. We use Schonhage

f_split02 = forward_split02(f_split01);
g_split02 = forward_split02(g_split01);


%TEST SECTION
f_split01_outTest = back_split02(f_split02);
g_split01_outTest = back_split02(g_split02);

disp('Test of forward_back_expandDimension')
[isequal(f_split01,f_split01_outTest), isequal(g_split01,g_split01_outTest)]


%ORIGINAL
% f_split02 = zeros(3,16,32); % x=1,2,3 , %z=0,...,15 (exponent of y) %y=0,...,31 (exponent of w), (zeros(row,column,row))
% g_split02 = zeros(3,16,32);
% 
% for cycle=1:3
%     for i=0:511
%         index_y_schonage = mod(i,16); % y^16=w
%         index_w_schonage = floor(i/16); % w^index
%         
%         f_split02(cycle,index_y_schonage+1,index_w_schonage+1) = f_split01(cycle,i+1);
%         g_split02(cycle,index_y_schonage+1,index_w_schonage+1) = g_split01(cycle,i+1);
%     
%     end
% end

% AT THIS POINT, WE ARE WORKING ON R[y,w]/(w^32-1)










 

%mod(h_expected,2^16)

%a = 65535;
%bitget(a,16:-1:1,'uint16')

%b= 17
%bitget(b,16:-1:1,'uint16')

%c = bitand(a,b,'uint16')
%bitget(c,16:-1:1,'uint16')


